@page "/categories/create"
@inject ApplicationDbContext DbContext
@inject UserState UserState
@inject NavigationManager Navigation

<PageTitle>Add Category</PageTitle>

<h1>âž• Add New Category</h1>

<EditForm Model="@category" OnValidSubmit="HandleSubmit">
    <div class="mb-3">
        <label>Name:</label>
        <InputText @bind-Value="category.Name" class="form-control" />
    </div>

    <div class="mb-3">
        <label>Description:</label>
        <InputText @bind-Value="category.Description" class="form-control" />
    </div>

    <div class="mb-3">
        <label>Icon:</label>
        <InputText @bind-Value="category.Icon" class="form-control" placeholder="e.g., ðŸ›’" />
        <small class="text-muted">Use an emoji</small>
    </div>

    <div class="mb-3">
        <label>Color:</label>
        <input type="color" @bind="category.ColorCode" class="form-control" />
    </div>

    <div>
        <button type="submit" class="btn btn-primary">Save</button>
        <a href="/categories" class="btn btn-secondary">Cancel</a>
    </div>
</EditForm>

@code {
    private Category category = new Category();

    private async Task HandleSubmit()
    {
        category.UserId = UserState.CurrentUserId;
        DbContext.Categories.Add(category);
        await DbContext.SaveChangesAsync();
        Navigation.NavigateTo("/categories");
    }
}