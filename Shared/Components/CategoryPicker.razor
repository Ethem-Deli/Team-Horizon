@using FamilyBudgetExpenseTracker.Models

<select class="form-select" value="@ValueString" @onchange="OnChanged" disabled="@Disabled">
    <option value="">-- Select Category --</option>
    @if (Categories != null)
    {
        @foreach (var c in Categories)
        {
            <option value="@c.Id">@($"{c.Icon} {c.Name}".Trim())</option>
        }
    }
</select>

@code {
    [Parameter] public IEnumerable<Category>? Categories { get; set; }
    [Parameter] public int? Value { get; set; }
    [Parameter] public EventCallback<int?> ValueChanged { get; set; }
    [Parameter] public bool Disabled { get; set; }

    private string ValueString => Value?.ToString() ?? "";

    private async Task OnChanged(ChangeEventArgs e)
    {
        var s = e.Value?.ToString();
        if (string.IsNullOrWhiteSpace(s))
        {
            await ValueChanged.InvokeAsync(null);
            return;
        }

        if (int.TryParse(s, out var id))
        {
            await ValueChanged.InvokeAsync(id);
        }
    }
}