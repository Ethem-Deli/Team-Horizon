@using Microsoft.JSInterop
@inject Microsoft.JSInterop.IJSRuntime JS

<div class="chart-container">
    <canvas id="@CanvasId"></canvas>
</div>

@code {
    [Parameter] public string CanvasId { get; set; } = "expenseChart";
    [Parameter] public List<string> Labels { get; set; } = new();
    [Parameter] public List<double> Values { get; set; } = new();
    [Parameter] public bool RenderAsPie { get; set; }

    private bool _pending;

    protected override void OnParametersSet()
    {
        _pending = true;
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!_pending) return;
        _pending = false;

        if (Labels.Count == 0) return;

        if (RenderAsPie)
            await JS.InvokeVoidAsync("budgetCharts.renderPie", CanvasId, Labels, Values);
        else
            await JS.InvokeVoidAsync("budgetCharts.renderBar", CanvasId, Labels, Values);
    }
}